
#define DISPLAY_OFF 0xAE
#define MEMORY_ADRESSING_MODE 0x20
#define ADRESSING_MODE_HORIZONTAL 0x00
#define ADRESSING_MODE_VERTICAL 0x01
#define ADRESSING_MODE_PAGE 0x10
#define PAGE_START_ADRESSING 0xB0
#define COM_OUTPUT_SCAN_DIRECTION 0xC8
#define LOW_COLUMN_ADRESS 0x00
#define HIGH_COLUMN_ADRESS 0x10
#define START_LINE_ADRESS 0x40
#define CONTRAST_CONTROL_REGISTER 0x81
#define SEGMENT_REMAP 0xA1
#define NORMAL_DISPLAY 0xA6
#define MULTIPLEXER_RATIO 0xA8
#define OUTPUT_FOLLOWS_RAM_CONTENT 0xA4
#define OUTPUT_IGNORES_RAM_CONTENT 0xA5
#define DISPLAY_OFFSET 0xD3


typedef struct {
	uint8_t width;
	uint8_t height;
	uint8_t inverted;
	uint8_t initialized;
	uint8_t ssd1306Buffer[];
	I2C_HandleTypeDef ssd1306;
} SSD1306_t;

void Init(SSD1306_t ssd1306) {
	SSD1306_WRITECOMMAND(DISPLAY_OFF);
	SSD1306_WRITECOMMAND(MEMORY_ADRESSING_MODE);
	SSD1306_WRITECOMMAND(ADRESSING_MODE_VERTICAL);
	SSD1306_WRITECOMMAND(PAGE_START_ADRESSING);
	SSD1306_WRITECOMMAND(COM_OUTPUT_SCAN_DIRECTION);
	SSD1306_WRITECOMMAND(LOW_COLUMN_ADRESS);
	SSD1306_WRITECOMMAND(HIGH_COLUMN_ADRESS);
	SSD1306_WRITECOMMAND(START_LINE_ADRESS);
	SSD1306_WRITECOMMAND(CONTRAST_CONTROL_REGISTER);
	SSD1306_WRITECOMMAND(0xFF);
	SSD1306_WRITECOMMAND(SEGMENT_REMAP);
	SSD1306_WRITECOMMAND(NORMAL_DISPLAY);
	SSD1306_WRITECOMMAND(MULTIPLEXER_RATIO);
	SSD1306_WRITECOMMAND(0x3F);
	SSD1306_WRITECOMMAND(OUTPUT_FOLLOWS_RAM_CONTENT);
	SSD1306_WRITECOMMAND(0xD3); //-set display offset
	SSD1306_WRITECOMMAND(0x00); //-not offset
	SSD1306_WRITECOMMAND(0xD5); //--set display clock divide ratio/oscillator frequency
	SSD1306_WRITECOMMAND(0xF0); //--set divide ratio
	SSD1306_WRITECOMMAND(0xD9); //--set pre-charge period
	SSD1306_WRITECOMMAND(0x22); //
	SSD1306_WRITECOMMAND(0xDA); //--set com pins hardware configuration
	SSD1306_WRITECOMMAND(0x12);
	SSD1306_WRITECOMMAND(0xDB); //--set vcomh
	SSD1306_WRITECOMMAND(0x20); //0x20,0.77xVcc
	SSD1306_WRITECOMMAND(0x8D); //--set DC-DC enable
	SSD1306_WRITECOMMAND(0x14); //
	SSD1306_WRITECOMMAND(0xAF); //--turn on SSD1306 panel
}
